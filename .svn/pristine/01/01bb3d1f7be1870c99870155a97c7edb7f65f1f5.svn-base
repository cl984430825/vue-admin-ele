<template>
  <div id="detail">
    <div class="detail_container">
      <el-tabs v-model="activeIndex" @tab-click="handleClick">
        <el-tab-pane label="基础信息" name="1">
          <div class="form_box">
            <el-form :model="ruleForm" :rules="rules" ref="ruleForm" label-width="100px" class="demo-ruleForm">
              <el-form-item label="物资ID：" prop="supplieseID">
                <span>WZ001</span>
              </el-form-item>
              <el-form-item label="物资名称：" prop="supplieseName">
                <el-input 
                clearable
                maxlength="20"
                style="width:260px" 
                v-model="ruleForm.supplieseName" 
                placeholder="请输入物资名称"></el-input>
              </el-form-item>
              <el-form-item label="品牌型号：" prop="ppxh">
                <el-input 
                clearable 
                style="width:260px" 
                v-model="ruleForm.ppxh" 
                placeholder="请输入品牌型号"></el-input>
              </el-form-item>
              <el-form-item label="供应商：" prop="gys">
                <el-input 
                clearable 
                style="width:260px" 
                v-model="ruleForm.gys" 
                placeholder="请输入供应商"></el-input>
              </el-form-item>
              <el-form-item label="单位：" prop="dw">
                <el-input 
                clearable 
                style="width:260px" 
                v-model="ruleForm.dw" 
                placeholder="请输入单位"></el-input>
              </el-form-item>
              <el-form-item label="均价：" prop="jj">
                <span>1,500</span>
              </el-form-item>
              <el-form-item label="结存数量：" prop="jcNum">
                <span>1,00</span>
              </el-form-item>
              <el-form-item label="结存金额：" prop="jcMoney">
                <span>150,500</span>
              </el-form-item>
              <el-form-item label="编号前缀：" prop="bhqz">
                <span>CL</span>
              </el-form-item>
              <el-form-item label="备注：" prop="remark">
                <el-input 
                clearable
                style="width:260px" 
                v-model="ruleForm.remark"
                placeholder="请输入备注"></el-input>
              </el-form-item>
              <el-form-item label="类型" prop="type">
                <el-select v-model="ruleForm.type">
                  <el-option
                  :key="index"
                  :value="index"
                  :label="item"
                  v-for="(item, index) in typeList"></el-option>
                </el-select>
              </el-form-item>
              <el-form-item>
                <el-button size="medium" type="primary">
                  <i class="el-icon-document-add"></i>
                  <span>保存</span>
                </el-button>
                <el-button @click="toBack" size="medium">返回列表</el-button>
              </el-form-item>
            </el-form>
          </div>
        </el-tab-pane>
        <el-tab-pane label="批次信息" name="2">
          <div class="table_box">
            <div class="flexBetween">
              <el-input 
              clearable
              v-model="projectSearch"
              style="width:300px" 
              placeholder="批次/编号/发票号">
                <el-button slot="append" icon="el-icon-search"></el-button>
              </el-input>
              <div class="flexBox">
                <el-button @click="dialogVisible=true" type="primary" size="medium">+ 入库</el-button>
                <el-button @click="dialogVisible=true" type="primary" size="medium">+ 出库</el-button>
                <el-button @click="dialogVisible=true" type="primary" size="medium">+ 退回</el-button>
                <el-button size="medium">导出</el-button>
              </div>
            </div>
            <el-table 
            border
            class="_top"
            :data="projectTable"
            :header-cell-style="{background:'#F6F5F4'}">
              <el-table-column label="批次" width="200">1</el-table-column>
              <el-table-column label="编号" width="200">-</el-table-column>
              <el-table-column label="结存数量" width="100">-</el-table-column>
              <el-table-column label="单价" width="100">-</el-table-column>
              <el-table-column label="结存金额" width="150">-</el-table-column>
              <el-table-column label="发票号" width="100">-</el-table-column>
              <el-table-column label="开票时间" width="100">-</el-table-column>
              <el-table-column label="存放地点" width="100">-</el-table-column>
              <el-table-column label="备注" width="100">-</el-table-column>
              <el-table-column label="操作" fixed="right" width="160">
                <template slot-scope="scope">
                  <span class="blueText">出库</span>
                  <span class="blueText _left">编辑</span>
                  <span class="blueText _left">删除</span>
                </template>
              </el-table-column>
            </el-table>
            <Page :pageConfig="pageConfig" />
          </div>
        </el-tab-pane>
        <el-tab-pane label="出入库明细" name="3">
          <div class="table_box">
            <div class="flexBetween">
              <div class="flexBox">
                <div class="flexBox">
                  <span class="labelCls searchLabel">类型：</span>
                  <el-radio-group v-model="engType" size="medium">
                    <el-radio-button label="">全部</el-radio-button>
                    <el-radio-button label="1">出库</el-radio-button>
                    <el-radio-button label="2">入库</el-radio-button>
                    <el-radio-button label="3">退回</el-radio-button>
                  </el-radio-group>
                </div>
                <el-input 
                  clearable
                  class="_left"
                  v-model="engineerSearch"
                  style="width:300px" 
                  placeholder="批次/编号/发票号">
                  <el-button slot="append" icon="el-icon-search"></el-button>
                </el-input>
              </div>
              <el-button size="medium">导出</el-button>
            </div>
            <el-table border class="_top" :data="engTable" :header-cell-style="{background:'#F6F5F4'}">
              <el-table-column label="物资批次">1</el-table-column>
              <el-table-column label="物资编号">2</el-table-column>
              <el-table-column label="数量">3</el-table-column>
              <el-table-column label="单价">4</el-table-column>
              <el-table-column label="合计金额">5</el-table-column>
              <el-table-column label="操作时间">1</el-table-column>
              <el-table-column label="发票号">2</el-table-column>
              <el-table-column label="开票时间">123</el-table-column>
              <el-table-column label="存放地点">123</el-table-column>
              <el-table-column label="结存金额">123</el-table-column>
              <el-table-column label="结存数量">123</el-table-column>
              <el-table-column label="备注" width="120">-</el-table-column>
            </el-table>
            <Page :pageConfig="endPageConfig" />
          </div>
        </el-tab-pane>
      </el-tabs>
    </div>
    <el-dialog
      width="50%"
      title="添加项目"
      :visible.sync="dialogVisible">
      <el-form :model="projectForm" :rules="projectFormRules" ref="ruleForm" label-width="100px" class="demo-ruleForm">
        <div class="flexBox">
          <el-form-item label="合同号：" prop="hth" class="flexFormItem">
            <el-input v-model="projectForm.hth"></el-input>
          </el-form-item>
          <el-form-item label="项目内容：" prop="xmnr" class="flexFormItem">
            <el-input v-model="projectForm.xmnr"></el-input>
          </el-form-item>
        </div>
        <div class="flexBox">
          <el-form-item label="签订日期：" prop="qdrq" class="flexFormItem">
            <el-date-picker
              v-model="projectForm.qdrq"
              type="date"
              placeholder="签订日期">
            </el-date-picker>
          </el-form-item>
          <el-form-item label="合同对方：" prop="htdf" class="flexFormItem">
            <el-input v-model="projectForm.htdf"></el-input>
          </el-form-item>
        </div>
        <div class="flexBox">
          <el-form-item label="合同金额：" prop="htje" class="flexFormItem">
            <el-input v-model="projectForm.htje"></el-input>
          </el-form-item>
          <el-form-item label="默认税率：" prop="mrsl" class="flexFormItem">
            <el-input-number v-model="projectForm.mrsl" controls-position="right" :min="1"></el-input-number> %
          </el-form-item>
        </div>
        <div class="flexBox">
          <el-form-item label="已支付：" prop="yzf" class="flexFormItem">
            <div class="flexBox">
              <el-input v-model="projectForm.yzf" disabled>
                <template slot="prepend">￥</template>
              </el-input>
              <span class="blueText _left">付款记录</span>
            </div>
          </el-form-item>
          <el-form-item label="未支付：" prop="wzf" class="flexFormItem">
            <el-input v-model="projectForm.wzf" disabled>
              <template slot="prepend">￥</template>
            </el-input>
          </el-form-item>
        </div>
        <el-form-item label="付款方式：" prop="fkfs" class="flexFormItem">
          <el-input v-model="projectForm.fkfs"></el-input>
        </el-form-item>
        <el-divider content-position="center">
          <span class="labelCls">根据发票信息自动统计填写</span>
        </el-divider>
        <div class="flexBox">
          <el-form-item label="发票未税：" prop="fpws" class="flexFormItem">
            <el-input v-model="projectForm.fpws" disabled>
              <template slot="prepend">￥</template>
            </el-input>
          </el-form-item>
          <el-form-item label="发票含税：" prop="fphs" class="flexFormItem">
            <el-input v-model="projectForm.fphs" disabled>
              <template slot="prepend">￥</template>
            </el-input>
          </el-form-item>
        </div>
        <div class="flexBox">
          <el-form-item label="暂估未税：" prop="zgws" class="flexFormItem">
            <el-input v-model="projectForm.zgws" disabled>
              <template slot="prepend">￥</template>
            </el-input>
          </el-form-item>
          <el-form-item label="暂估含税：" prop="zghs" class="flexFormItem">
            <el-input v-model="projectForm.zghs" disabled>
              <template slot="prepend">￥</template>
            </el-input>
          </el-form-item>
        </div>
        <el-form-item>
          <el-button type="primary" size="medium">确 定</el-button>
          <el-button size="medium">取 消</el-button>
        </el-form-item>
      </el-form>
    </el-dialog>
  </div>
</template>

<script>
export default {
  name: "detail",
  components: {
    "Page": resolve => require(["@/components/page.vue"], resolve)
  },
  data () {
    return {
      // tab选中项
      activeIndex: "1",
      // 基础信息表单
      ruleForm: {
        supplieseName: "",
        ppxh: "",
        gys: "",
        dw: "",
        remark: "",
        type: 0
      },
      // 表单校验规则
      rules: {
        supplieseName: { required: true, message: '请输入物资名称', trigger: 'blur' },
        ppxh: { required: true, message: '请输入品牌型号', trigger: 'blur' },
        gys: { required: true, message: '请输入供应商', trigger: 'blur' },
        dw: { required: true, message: '请输入单位', trigger: 'blur' },
      },
      // 类型列表
      typeList: ["工程物资", "在建工程", "低值易耗", "办公用品", "固定资产", "无形资产", "贸易材料", "研发材料", "库存商品", "劳保用品"],
      // 批次信息索引项
      projectSearch: "",
      // 出入库明细索引项
      engineerSearch: "",
      // 出入库检索类型
      engType: "",
      // 批次信息table
      projectTable: [1,2,3],
      // 出入库明细table
      engTable: [1,2,3],
      // 批次信息分页配置项
      pageConfig: {
        pageNum: 1,
        pageSize: 10,
        total: 0
      },
      // 出入库明细分页配置项
      endPageConfig: {
        pageNum: 1,
        pageSize: 10,
        total: 0
      },
      // 添加项目dialog
      dialogVisible: false,
      // 添加项目表单
      projectForm: {
        hth: "",
        xmnr: "",
        qdrq: "",
        htdf: "",
        htje: "",
        mrsl: "",
        yzf: "",
        wzf: "",
        fkfs: "",
        fpws: "",
        fphs: "",
        zgws: "",
        zghs: ""
      },
      // 项目表单校验规则
      projectFormRules: {
        hth: { required: true, message: '请输入合同号', trigger: 'blur' },
        xmnr: { required: true, message: '请输入项目内容', trigger: 'blur' },
        qdrq: { required: true, message: '请选择签订日期', trigger: 'blur' },
        htdf: { required: true, message: '请输入合同对方', trigger: 'blur' },
        htje: { required: true, message: '请输入合同金额', trigger: 'blur' },
      }
    }
  },
  methods: {
    // 编辑项目信息
    compileProject(scope){
      this.dialogVisible = true;
    },
    // 发票管理
    toInvoice(scope){
      this.$router.push("/engineering/invoiceMng");
    }
  }
}
</script>

<style scoped>
.detail_container{
  background: #ffffff;
}
.form_box{
  padding: 20px 20px 0 20px;
}
.table_box{
  padding: 10px 20px 20px 20px;
}
.flexFormItem{
  width: 100%;
}
</style>
